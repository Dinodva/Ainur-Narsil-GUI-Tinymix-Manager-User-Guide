# Ainur-Narsil-GUI-Tinymix-Manager-User-Guide
It is not exactly correct to say that Tinymix Manager is the GUI for Ainur Narsil audio mod, since it does not interacting with the app itself directly. But as the matter of fact, Ainur Narsil has Tinymix binary built in and try to use some of its functions, as it can be seen from [here.](https://github.com/Magisk-Modules-Repo/ainur_narsil/blob/master/service.sh)  More correct would be say that Ainur Narsil removes all audio fx and opens under-surface audio fx interface functionality, and Tinymix on top of it allows modify some hidden system audio settings, in such way extending the functionality of Ainur Narsil without lowering audio quality towards  pcm16bit format in any way. So we have not only system level audio settings unobstructed, but also can further tweak them, which is not possible by any other means. Installing other popular audio mods here is not solution, for it brings us back to the point from where we have started, to pcm 16 bit audio format. I have tested many audio players (nearly half not even support uncompressed playback in any way) and most of Magisk audio mods with Flingerdamp.apk, and have found that where ever we switch mods on or start to use equalizers built into media players, the sound immediately becomes encoded into pcm 16bit (or in best scenario pcm24bit). That is why, I prefer to use simplest media player, without equalizer or any other tweaks, which is one built into Mixplorer, and which allows to listen music file as it is, without digital re-compression to pcm. Although and of course this is the mater of individual taste.
## Qualcomm Audio 
[Qualcomm Audio](https://www.qualcomm.com/products/internet-of-things/consumer/audio)  [(link 2)](https://www.qualcomm.com/products/internet-of-things/consumer/audio/mobile-audio) is integrated into core of the Qualcomm processors, but its full potential usually not properly implemented by Android developers and manufacturers due various reasons, such as licensing, personal interests, the safety of equipment (i.e. speakers & headphones), as well as safety of ears (which also could cost). That is why, as I have found, for example the HD mode for head phones wasn't activated by default on my Redmi 7, or Hifi sound was not activated by default on my Pixel 3, even after installing Ainur Narsil. So what point of having dedicated high level audio card and have no way to use it?
## Audio Modifications:
On older versions of Android, we could relatively easily edit values of mixer_path.xml, in accordance with our demands, but the newer versions of android made this process much more difficult. I have spent lot of time trying to make my system partition r/w, and have to reinstall OS anew after this, but was not able to implement properly working solution (without causing extra stress to my highly modified system) on A12 stock+microg. Besides, there are so many flavors of mixer path, as there devices models. This make impossible of creation of an universal audio module, which could fit to all devices. And here Tinymix Manager comes to help.  With the help of this program we can change different audio setting of inbuilt audio mixer easily. The most changes would survive till the next reboot, while some tweaks we have to enable while listening music, such as for example 'enable compression of gapless playback on-off'. Also potentially and probably for now, using the combination of Ainur Narsil+Tinymix, we can change those values permanently. This function is not tested much by me yet, but I will describe how to test and use it below.
## What is Tinymix?
Tinymix and Tinyalsa are the audio implementing components of Linux OS, borrowed by android developers along with other inbuilt components of Linux. In older versions of Android, approximately up to A9, the tinymix binaries were included as mandatory, but later they were abolished as obsolete by developers, who went other way, and never bother to properly implement their functionality into AOS. Instead of implementing dynamic functions of tinymix, developers have chosen to replace its function by static mixer_path.xml. Despite this sad fact, tinymix is still remains functional, but requires tinymix binaries along with GUI to function properly. And so far, it is the only working solution among many tasted by me, to modify mixer path values without actually modifying it, which is the Tinymix Manager app.
## Requirements:
Rooted phone with Magisk installed. I have tasted Tinymix Manager on Android 9-10, Lineage OS Microg  edition  Redmi7 and Stock A12 with Microg on Pixel 3. In both causes it was working properly. And both are Qualcomm devices. Since MTK devises may have different audio implementation (never bothered to check up or not remember), I doubt that Tinymix Manager could work properly on non Qualcomm devices. Also, I doubt Exinos devices. Both tested rooms have signature spoofing enabled, but I do not think it requires for it to work properly. Magisk versions 20 to 27. And in cause if you decide to go for Magisk Module installation of the Tinymix Manager as the system program, it is desirable to have custom recovery installed in cause of any problems.
## Implementation:
There are tree possible installations of Tinymix: first original apk with less permissions. This version available in three formats: arm7, arm8 and x86. Second is modified by me apk, which is only for arm8. My mod has more audio and system related permissions (I only edited Android manifest xml). Note: the both above mentioned apks are very primitive, and have only functionality related to tinymix.bin and audio flinger lib.so (built in). They didn't have internet access interface on any level. The third possible implementation is to install Tinymix Manager as system app via provided by me Magisk module, in cause if you were not satisfied with both above mentioned solutions. I personally use this method, actually I have assembled this module for myself.
## Installation

***Install as apk:***   first flash Ainur Narsil via Magisk and reboot. Then install Tinymix Manager apk of your choice as regular apk. Open it and enable super user rights for the app when you would be prompted. If opened window of apk blank, it means that you don't have Tinymix binaries in your system. In such case, you have to flash Tinymix Binaries Installer Magisk module and reboot. After this you can use the app to change different values of audio settings of inbuilt android mixer. If original version with less permissions doesn't worked for you then try modified version. 
***Install as Magisk module:*** This is more risky setup and I wouldn't recommend you to do this if you don't have custom recovery installed. I recommend make clear install on fresh rom, without AML or any audio modules. Otherwise it could potentially mess up all around. I have tried two installation methods, one with Ainur Narsil first, and other with Ainur Narsil on top of Tinymix. The second method I have tried, desiring to see, if I could get the same performance without Ainur Narsil. The results were unsatisfactory, therefore I flashed AN on top of TM. The second method was working for me better, since after it, I have 'hifi mode on' and headphones set to 'hifi AB' on permanent basis, which survive through numerous reboots. Hope this wouldn't upset battery much. To be honest, I was much surprised to see this happen. I was listening music with these options enabled in Tinymix Manager and then I flashed Ainur Narsil above it, without changing them back. And since then for many reboots these values remain unchanged, while few others I still have to change manually each reboot.  I did not tasted this method with other settings for second time, for I have tied from starting from 'zero point' and for now have no time left, but there are chances that it may work also for you. That is speculation so far: I am still not sure 100%, but probably and potentially Ainur Narsil could be used as well as 'fixer' of values set in Tinymix before flashing it. Note: in first install without permanent changes, I have used AN last version of 2022. In second time I used AN mod of 2023. But I do not think that difference of versions have caused this permanent change of values. Also, value 'hifi function on' is not found in the mixer path xml.
***How to:*** *Method 1:* This method is less complicated and troublesome then second. First install Ainur Narsil Magisk Module of your choice (2022 or 2023) and reboot device. Then install Tinymix Manager Installer Magisk module (there two versions with old and new templates) and reboot device. Binaries, permission and audio flinger are inbuilt into the module, so no need in separate flashing of binaries module. If you have it installed then remove and reboot before install. Then check if your media player correctly works after this. If there is no sound, while playing mp3 or m4a then reinstall media player again. If there is still not sound, then install apk from module (open it as archive) on top of it and reboot. If there still no sound, then reinstall media player again. You can also try to clear cache via recovery. Now it should work for you or at least it is worked for me. If you are planing to install more audio mods then you have to install Audio Modification Library on top of this setup. ***Note:*** after installing AML there are chances that sound of media player may disappear again. To make it work repeat the steps mentioned above. 
***The Method Two*** is similar in details, but first you have change the values you want to keep as permanent in Tinymix Manager. Then flash AN and AML as described above. It is took few more reinstalls and reboots to make this setup working properly.
## Troubleshooting:
There few problems you may encounter, few of which were described above, which is loosing sound in audio playback. Note: video playback was always OK, despite any changes. While using Tinymix,   I have found that adding some controls to favorites may make your favorites window grey-out with all values disappearing (as for example hifi function on off). In such cause just remove those values from favorites and all would return back. It is duty this reason that I went from apk to Magisk module, while probably apk could do the same work without that much complexity and risk. I did not tested this properly. So please do not repeat my mistake, this graying out happens with Magisk module installation as well.  If apk is works for you, then just use it and not go for Magisk version. So far, I have tried only old Magisk Module, I have assembled 3 years ago. With this module, there was no any problem with installation, but I have caught bootloop after I have uninstalled it. I came out of it by rebooting into recovery, flashing module again and clearing cache. Please be aware of this potential problem. I will make new module, which is based on new template, but I didn't tasted it, only tested template's install-uninstall with other apps inbuilt. 
## Disclaimer:
So do everything at your own risk. I am not responsible for any potential damage of your device and files. Take red pill or blue is your own chance, be aware of what you are doing. Never rush.
## Which Settings Could be Changed via TM?
Certainly this aps has its advantages and limitations. With my new version of mixer path (Pixel 3 with dedicated sound card), Tinymix Manager have  2972 controls, not all of which cold be changed, and only few of them are practically useful. In comparison my Redmi 7 (no sound card) has 2802 controls, many of which are different from Pixel 3.  In such way, Redmi 7 has only one HD mode for headphone (HD mode-Normal), while Pixel 3 has 7 modes, few of which are HIFI. Similarly, in dependence on you mobile hardware and mixer path, your device may have more or less controls appearing in Tinymix Manager. 
## Why to use Tinymix Manager along with Ainur Narsil?
The main purpose of such implementation is that we can listen uncompressed pure sound in the way it was composed, with enabling extra features embodied into Qualcomm chips, such as HIFI Sound (i.e. dedicated audio card) and others similar to it features. As I already have mentioned above, enabling any software level equalizers or other functions related to audio fx libs, immediately push our device into pcm vortex. Nevertheless, we can still use audio mods such as Dolby Atomos, Viperfx, Dirac or James DSP, side by side with the above mentioned implementation. Just for having 'gentlemen set', I have flashed three modern Dolby Atomos modules and few similar, all attempts ended in bootloops. Have to uninstall them from recovery. Installed modern Viper, (before I use to keep it for its Neon driver), it nearly blow my headphone with infra-sound when I enabled ultra bass. And so on... I can continue this list. My old Redmi 7 has Dolby, Viper FX, Dirac (made by me), but I actually never use them because of their PCM side effect. Also I have tested many more audio modules on it (all available via internet), many of which were working, but I didn't liked any one of them. ***Note:*** once pcm playback mode becomes activated, it becomes difficult to come out of it without rebooting system. That is why, if we want to keep our playback clean from any lib audio fx along with pcm compressing (audio standard), and be able to use some advanced extra features inbuilt into Qualcomm chips, the combination of Ainur Narsil and Tinymix is optimal for us.
## Practical Use:
I personally use very few different controls tweaked for different purposes, such as playback and video recording.
 
***Playback:*** 
For playback in audio player I use such controls as 'hifi mode on off (by default it is off), so I switch it on. Plus enabled hifi mode for headphones, which is RX HPH Mode CLS_AB_HIFI (by default it is CLS_H_LP). Plus switch off "Compress gapless playback' on=off (by default it is on). ***Note:*** This function stays 'off', as long as you use some audio interface, then returns to default value. While watching Youtube, I enable inbuilt into processor Dolby Surround, which is DS 2 on=off (by default it is off) along with two first functions mentioned above. The third function I sometimes use, sometimes not along with it, or sometimes use without it. DS makes some softer bass and surround playback. The sound is much better then with Dolby Atomos module. Also I do not have Youtube app, but instead use somewhat older version of Kiwi Browser with few extensions, it is sounds great. Later versions have corrupted Youtube interface playback, to force us use Youtube app with its adds. That is all. If your device don't have dedicated sound card, then instead of hifi, you have to find HD mode for headphones.

***For Video Recording:***
There are few Tinymix Manager controls which are useful for video recording. To increase video recording sound, we have to use value DEC. By default it is usually 84 on most phones, so we can rise it to 96-100. ***Note:*** different mixer path have different DEC number values. For example to increase sound on my Redmi 7, I have to change values of DEC1, DEC2 and DEC3. While on my Pixel 3, I have to change DEC5, DEC6 and DEC 8 values to achieve the same effect. To configure DEC value of your device, you have to fine DEC values in the mixer path of your device, assigned to camcorder or recording. ***Note:*** if you have custom kernel with audio controls built in it, then more likely you can't change dec values vie Tinymix Manager, but have to do it via one of kernel manger apks. Another interest value I use is AMIC_1_2_PWR_MODE (3_4), or in other words, analog microphone power mode. It can be changed to default, LOW_PWR, HIGH_PERF and HYBRID. Another interesting function related to audio recording you can experiment with is ADC. So these are the functions I am using personally. But there many others also, with which you can experiment, such as HD voice enable, Voice Sidetone Enable (on-off), VOIP DTX mode (on-off), ANC Function (on-off) and many more.
 
***How to use Timymix Manager:***

Open app and left window search for desired controls you want to change. Once you found them add them to favorites, so that you can latter easy access and change them. Generally to speak, all recording related staff is TX, all playback related staff is RX, Headphone related staff, search for hph, volume search for volume and so on. I wouldn't recommend to change too many values, besides mentioned above, since it may temporally corrupt your device integrated audio performance. But then you can simply reboot and all changes would disappear.
## Tinymix Manager for Developers:
Using Tinymix we can check values we want to change into mixer path, without need for each time pasting it into vendor. Also we can use Tinymix to see how different audio Magisk modules have changed our device audio configuration in real time.
